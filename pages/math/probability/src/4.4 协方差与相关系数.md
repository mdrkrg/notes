---
tags:
  - DataScience
  - SJTU-Statistics
---
4.4 协方差与相关系数
===
> [!summary]
> **协方差计算公式**
> $$\operatorname{cov}(X,Y)=E(X Y)-E(X) E(Y)$$
> $$D(X \pm Y)=D(X)+D(Y) \pm 2 \operatorname{cov}(X, Y)$$
>
> **相关系数**
> $$\rho_{X Y}=\frac{\operatorname{cov}(X,Y)}{\sqrt{D(X)} \sqrt{D(Y)}}$$
>
> #### 性质
> **线性性** (由定义或公式得到)
> $$\operatorname{cov}(a X,b Y)=a b \operatorname{cov}(X,Y)$$
> $$\operatorname{cov}(X,Y)=\operatorname{cov}(X-a,Y-b)$$
>
> **线性可加性**
> $$\operatorname{cov}(X+Y,Z)=\operatorname{cov}(X,Z)+\operatorname{cov}(Y,Z)$$

## 概念
**协方差**

随机变量 $X, Y$ 的协方差为

$$\mathrm{cov}(X,Y) = E[(X-E(X))(Y-E(Y))]$$
- $D(X) = \mathrm{cov}(X,X)$

**相关系数**

当 $D(X)>0, D(Y)>0$, 则有 $X$ 与 $Y$ 的相关系数

$$\rho_{X Y}=\frac{\operatorname{cov}(X,Y)}{\sqrt{D(X)} \sqrt{D(Y)}}$$
- 相关系数为标准化的协方差 $\rho_{XY} = \mathrm{cov}(X^*,Y^*)$
- $\rho_{XY} = 0$ 时, $X$ 与 $Y$ **不相关**

**协方差矩阵**

$$\left(\begin{array}{cc}
D(X) & \operatorname{cov}(X, Y) \\
\operatorname{cov}(X, Y) & D(Y)
\end{array}\right)$$

## 计算
### 公式
$$\operatorname{cov}(X,Y)=E(X Y)-E(X) E(Y)$$
$$D(X \pm Y)=D(X)+D(Y) \pm 2 \operatorname{cov}(X, Y)$$

### 定义
**离散型**

$$\operatorname{cov}(X,Y)=\sum_{i=1}^{+\infty} \sum_{j=1}^{+\infty}\left[x_{i}-E(X)\right]\left[y_{j}-E(Y)\right] p_{i j}$$

**连续型**

$$\operatorname{cov}(X,Y)=\int_{-\infty}^{+\infty} \int_{-\infty}^{+\infty}[x-E(X)][y-E(Y)] f(x,y) \mathrm{d} x \mathrm{d} y$$
### 正态分布
$(X, Y) \sim N\left(\mu_{1}, \sigma_{1}^{2} ; \mu_{2}, \sigma_{2}^{2} ; \rho\right)$, 相关系数为 $\rho$

## 运算性质
### 协方差的性质
设以下随机变量的协方差存在

**可换性** $\operatorname{cov}(X,Y)=\operatorname{cov}(Y,X)$

**变量与常数的协方差**

$$\operatorname{cov}(X,C) = 0$$

**变量与自己的协方差为方差**

$$ \mathrm{cov}(X,X) = D(X)$$

**线性性** (由定义或公式得到)

$$\operatorname{cov}(a X,b Y)=a b \operatorname{cov}(X,Y)$$
$$\operatorname{cov}(X,Y)=\operatorname{cov}(X-a,Y-b)$$

**线性可加性**

$$\operatorname{cov}(X+Y,Z)=\operatorname{cov}(X,Z)+\operatorname{cov}(Y,Z)$$

**柯西施瓦茨不等式**

$$|\operatorname{cov}(X,Y)| \leqslant \sqrt{D(X)} \sqrt{D(Y)}$$

### 相关系数的性质
**规范性** $\left|\rho_{X Y}\right| \leqslant 1$

**随机变量完全相关**

$$\left|\rho_{X Y}\right| = 1\iff P(Y^* = \pm X^*) = 1$$
- $\rho_{X Y}=1 \iff P(Y^* = X^*) = 1$ 此时 $X,Y$ **完全正相关**
- $\rho_{X Y}= -1 \iff P(Y^* = -X^*) = 1$ 此时 $X,Y$ **完全负相关**

即 $|\rho_{XY}|$ 反映了由 $X$ 的线性函数 $aX+b$ 估计 $Y$ 所产生的均方误差的大小
- $$P(Y=aX+b)=1\,(a\neq0)\implies |\rho_{XY}| = 1$$


**\*均方误差**

$$\min\limits_{a,b} E\left\{\left[Y - (a + bX) \right]^2\right\}= E\left\{\left[Y - (a_0 + b_0X) \right]^2\right\}=\left(1 - \rho_{XY}^2\right) D(Y)$$
- $b_0 = \dfrac{\mathrm{cov}(X,Y)}{D(X)}$
- $a_0 = E(Y) - b_0 E(X)$

均方误差为关于 $|\,\rho_{XY}\,|$ 的严格递减函数
