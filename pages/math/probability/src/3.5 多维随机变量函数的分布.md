3.5 多维随机变量函数的分布
===
有时候分布已知, 但要求多个随机变量的**函数的**概率分布
## 多维离散型随机变量函数的分布
设 $(X,Y)$ 的联合分布律为 $P(X = x_i, Y=y_j) = p_{ij},(i,j = 1, 2, \cdots)$, $z = g(x,y)$ 为一个二元函数, $Z = g(X,Y)$ 为随机变量 $(X,Y)$ 的函数

假设 $Z$ 的全部不同取值记为 $z_k$, 并且所有使得 $g(x,y) = z_k$ 的点记为 $(x_{i_k},y_{j_k})$, 即 $z_k = g(x_{i_k},y_{j_k})$,
则 $Z$ 的分布律

$$P(Z = z_k) = P(g(X,Y) = z_k) = \sum_{g(x_{i_k},y_{j_k}) = z_k}P(X = x_{i_k},Y =y_{j_k}), \,k = 1, 2,\cdots$$

特别地, 当 $Z = X+Y$ 时,
$$P(Z=r)=P(X+Y=r)=\sum_{i=0}^{r} P(X=i,Y=r-i)$$

进一步, 当 $X$ 与 $Y$ 相互独立时, 若 $P(X=k)=a_{k},P(Y=k)=b_{k},k=0,1,2,\cdots$, 则 $Z = X+Y$ 的分布律满足**离散卷积公式**
$$P(Z=r)=\sum_{i=0}^{r} P(X=i) P(Y=r-i)=\sum_{i=0}^{r} a_{i} b_{r-i}$$

### 性质
1. Poisson 分布的可加性 (可推广到多个)

   若随机变量 $X, Y$ **相互独立**, 且都服从 Poisson 分布, 即 $X\sim P(\lambda_1), Y\sim P(\lambda_2)$, 则**其和也服从 Poisson 分布**, 即 
   $$X+Y\sim P(\lambda_1+\lambda_2)$$
2. ⼆项分布的可加性

   若随机变量 $X, Y$ **相互独立**, 且都服从二项分布, 即 $X\sim B(n,p), Y\sim B(m,p)$, 则**其和也服从二项分布**, 即
   $$X+Y\sim B(n+m, p)$$

## 多维连续型随机变量函数的分布
方法:
1. 从 $Z$ 的分布函数出发, 将 $Z$ 的分布函数转化为 $(X,Y)$ 的事件
2. 建立新的二维随机变量 $(Z, X)$ 或 $(Z, Y)$, 由边缘分布求 $Z$ 的概率密度函数

设 $(X,Y)$ 的联合概率密度为 $f(x,y)$, $g(x,y)$ 是一个二元函数
令 $Z = g(X,Y)$, 则 $Z$ 的分布函数
$$F_{Z}(z)=P(Z \le z)=P(g(X,Y) \le z)=\iint\limits_{g(x,y) \le z} f(x,y) \,\mathrm{d} x \,\mathrm{d} y$$
若有非负可积函数 $f_Z(z)$, 使得
$$F_{Z}(z)=\int_{-\infty}^{z} f_{Z}(u) \, \mathrm{d} u$$
则随机变量函数 $Z = g(X,Y)$ 的概率密度为
$$f_Z(z) = F'_Z(z)$$
### 基本方法
**和的分布** $Z = X + Y$

$$f_Z(z) = \int_{-\infty}^{+\infty}f(x,z-x)\,\mathrm dx = \int_{-\infty}^{+\infty}f(z-y,y)\,\mathrm dy$$

若 $X,Y$ 相互独立, 则
$$\begin{align}f_Z(z) &= \int_{-\infty}^{+\infty}f_X(x)\cdot f_Y(z-x)\,\mathrm dx\\
&=  \int_{-\infty}^{+\infty}f_X(z-y)\cdot f_Y(y)\,\mathrm dy \xlongequal{\triangle}f_X * f_Y(z)
\end{align}$$
函数 $f_Z(z)$ 称为称为函数 $f_X(x)$ 与 $f_Y(y)$ 的**卷积**

**线性函数的分布** $Z=a X+b Y+c$

更一般地, 设 $Z=a X+b Y+c$, $a,b,c$ 为常数, $a,b\neq0$,
$$f_{Z}(z)=\frac{1}{|b|} \int_{-\infty}^{+\infty} f\left(t,\frac{z-a t-c}{b}\right) \mathrm{d} t=\frac{1}{|a|} \int_{-\infty}^{+\infty} f\left(\frac{z-b t-c}{a},t\right) \mathrm{d} t$$

**商的分布** $Z = \dfrac XY$

> [!quote]- 推导过程
> $Z$ 的分布函数
> $$\begin{align}F_Z(z) &= P\left(\dfrac XY\le z\right)\\
> &= \iint\limits_{\frac xy\le z}f(x,y)\,\mathrm dx\,\mathrm dy \\&= \int_0^{+\infty}\mathrm dy\int_{-\infty}^{yz} f(x,y)\,\mathrm dx + \int^0_{-\infty}\mathrm dy\int_{yz}^{+\infty} f(x,y)\,\mathrm dx\end{align}$$

概率密度为
$$f_Z(z) = \int_{-\infty}^{+\infty}f(yz,y)\,|\,y\,|\,\mathrm dy$$
若 $X,Y$ 相互独立, 则
$$f_Z(z) = \int_{-\infty}^{+\infty}f_X(yz)\cdot f_Y(y)\,|\,y\,|\,\mathrm dy$$

**平方和的分布** $Z = X^2+Y^2$

$$f_{Z}(z)=\begin{cases}
0, & z<0 \\
\dfrac{1}{2} \displaystyle\int_{0}^{2 \pi} f(\sqrt{z} \cos \theta, \sqrt{z} \sin \theta) \mathrm{d} \theta, & z \geqslant 0
\end{cases}$$


**极值的分布** $M = \max\{X,Y\}, N = \min\{X, Y\}$

离散型随机变量: 直接计算

连续型随机变量: (==注意是分布函数==)
设 $X,Y$ 相互独立,
$$\begin{align}F_M(u) &= P(\max\{X,Y\}\le u)\\&=P(X\le u, Y\le u)\\&=P(X\le u)\cdot P(Y\le u)\\&= F_X(u)\cdot F_Y(u)\end{align}$$
$$\begin{align}F_N(v) &= P(\min\{X,Y\}\le v)\\&=1-P(X>v, Y>v)\\&=1-P(X> v)\cdot P(Y> v)\\&= 1 - \big(1-F_X(v)\big)\cdot \big(1-F_Y(v)\big)\end{align}$$

推广: $n$ 个相互独立的随机变量

采用连乘形式

**正态分布可加性**

若 $(X,Y)$ 是二维正态随机变量, $W,V$ 分别是 $X,Y$ 的线性组合, 
则 $(W,V)$ 也是二维随机变量

### \*变量代换法
设已知二维随机变量 $(X,Y)$ 的概率密度函数 $f_{XY}(x,y)$, 构造一个新的二维随机变量 $(Z,V)$, 满足

$$\begin{cases}
Z=g(X, Y) \\
V=r(X, Y)
\end{cases}$$

设 $\begin{cases} z=g(x, y) \\ v=r(x, y) \end{cases}$ 存在唯一的反函数 $\begin{cases} x=h(z, v) \\y=s(z, v)\end{cases}$

其中 $h,s$ 有连续偏导数, 记[[09.2 二重积分的计算#二重积分的变量代换|雅可比行列式]] 
$$J = \begin{vmatrix}h_z&h_v\\s_z&s_v\end{vmatrix}$$

则 
$$f_{ZV}(z,v) = f_{XY}\bigl(h(z,v),s(z,v)\bigr)\,|\,J\,|$$
